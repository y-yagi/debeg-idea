%h1
  = @idea.title

%hr

- if @comments.present?
  .list-group
    - @comments.select(&:persisted?).each do |comment|
      .list-group-item
        - if comment.user.try(:image_url)
          = image_tag(comment.user.image_url, width: 30, height: 30, alt: comment.user.nickname, title: comment.user.nickname).html_safe
          = comment.body
        - else
          = comment.body
        .pull-right
          イイネ!: #{ comment.like_comments.size }
          - if logged_in?
            - if @already_like_comments.include? comment.id
              = link_to('イイネ済み', like_comment_path(comment), class: 'btn btn-info disabled')
            - else
              = link_to('イイネ!', like_comment_path(comment), method: :post, remote: true,
                  class: 'btn btn-info', id: "like_comment_#{comment.id}", onclick: "like(like_comment_#{comment.id})")
- if logged_in?
  = form_for [@idea, @comment] do |f|
    - if @comment.errors.any?
      .alert.alert-danger
        %ul
          - @comment.errors.full_messages.each do |msg|
            %li
              = msg
    .form-group
      = f.text_area :body, class: 'form-control', placeholder: 'コメント'
    = f.submit 'コメントを送信する', class: 'btn btn-success'
- else
  %p
    コメントを追加するためには#{ link_to 'ログイン', '/auth/twitter' }が必要です。

